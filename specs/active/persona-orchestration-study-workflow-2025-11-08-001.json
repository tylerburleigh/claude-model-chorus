{
  "spec_id": "persona-orchestration-study-workflow-2025-11-08-001",
  "generated": "2025-11-08T14:00:00Z",
  "last_updated": "2025-11-08T15:43:29.469219Z",
  "metadata": {
    "title": "Persona Orchestration - STUDY Workflow",
    "description": "Implement persona-based investigation workflow with multi-perspective reasoning, temporal memory, and LLM-based routing",
    "status": "active",
    "complexity": "high",
    "estimated_hours": 64,
    "review": {
      "status": "not_reviewed",
      "last_reviewed": null,
      "reviewers": [],
      "total_reviews": 0,
      "history": []
    },
    "activated_date": "2025-11-08T14:53:02.145575Z",
    "progress_percentage": 20,
    "current_phase": "phase-1"
  },
  "objectives": [
    "Enable multi-perspective investigation through sequential persona reasoning",
    "Implement temporal memory system for cross-session investigation continuity",
    "Create LLM-based routing for intelligent persona selection",
    "Integrate STUDY workflow into ModelChorus CLI and architecture",
    "Provide comprehensive testing and documentation"
  ],
  "hierarchy": {
    "spec-root": {
      "type": "spec",
      "title": "Persona Orchestration - STUDY Workflow",
      "status": "in_progress",
      "parent": null,
      "children": [
        "phase-1",
        "phase-2",
        "phase-3",
        "phase-4",
        "phase-5",
        "phase-6"
      ],
      "total_tasks": 70,
      "completed_tasks": 14,
      "metadata": {
        "description": "Complete implementation of STUDY workflow with personas, memory, and routing"
      }
    },
    "phase-1": {
      "type": "phase",
      "title": "Foundation & Core Architecture",
      "status": "in_progress",
      "parent": "spec-root",
      "children": [
        "phase-1-files",
        "phase-1-verify"
      ],
      "total_tasks": 16,
      "completed_tasks": 14,
      "metadata": {
        "purpose": "Establish foundational architecture, data models, and workflow structure",
        "risk_level": "medium",
        "estimated_hours": 12
      },
      "dependencies": {
        "blocks": [
          "phase-2"
        ]
      }
    },
    "phase-1-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "completed",
      "parent": "phase-1",
      "children": [
        "task-1-1",
        "task-1-2",
        "task-1-3",
        "task-1-4",
        "task-1-5",
        "task-1-6"
      ],
      "total_tasks": 13,
      "completed_tasks": 13,
      "metadata": {
        "needs_journaling": false,
        "completed_at": "2025-11-08T15:41:55.900218Z",
        "journaled_at": "2025-11-08T15:41:55.924886Z"
      },
      "dependencies": {
        "blocks": [
          "phase-1-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-1-1": {
      "type": "task",
      "title": "Analyze existing workflow patterns and architecture",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [
        "task-1-1-1",
        "task-1-1-2",
        "task-1-1-3"
      ],
      "dependencies": {
        "blocks": [
          "task-1-2",
          "task-1-3"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 3,
      "metadata": {
        "task_category": "investigation",
        "estimated_hours": 2,
        "description": "Study BaseWorkflow, RoleOrchestrator, and ConversationMemory patterns"
      }
    },
    "task-1-1-1": {
      "type": "subtask",
      "title": "Review BaseWorkflow interface and inheritance pattern",
      "status": "completed",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "reference_file": "model_chorus/src/model_chorus/core/base_workflow.py",
        "started_at": "2025-11-08T14:57:56.966343Z",
        "completed_at": "2025-11-08T15:00:13.427479Z",
        "needs_journaling": false,
        "actual_hours": 0.038,
        "journaled_at": "2025-11-08T15:00:13.440432Z"
      }
    },
    "task-1-1-2": {
      "type": "subtask",
      "title": "Study RoleOrchestrator for persona implementation pattern",
      "status": "completed",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "reference_file": "model_chorus/src/model_chorus/core/role_orchestration.py",
        "started_at": "2025-11-08T15:06:34.570449Z",
        "completed_at": "2025-11-08T15:09:56.201497Z",
        "needs_journaling": false,
        "actual_hours": 0.056,
        "journaled_at": "2025-11-08T15:09:56.209633Z"
      }
    },
    "task-1-1-3": {
      "type": "subtask",
      "title": "Examine ConversationMemory for state persistence approach",
      "status": "completed",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "reference_file": "model_chorus/src/model_chorus/core/conversation.py",
        "started_at": "2025-11-08T15:17:48.783723Z",
        "completed_at": "2025-11-08T15:21:15.171787Z",
        "needs_journaling": false,
        "actual_hours": 0.057,
        "journaled_at": "2025-11-08T15:21:15.182713Z"
      }
    },
    "task-1-2": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/__init__.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-1-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/__init__.py",
        "task_category": "implementation",
        "estimated_hours": 0.5,
        "description": "Create STUDY workflow package with exports",
        "started_at": "2025-11-08T15:29:37.896814Z",
        "completed_at": "2025-11-08T15:30:22.510646Z",
        "needs_journaling": false,
        "actual_hours": 0.012,
        "journaled_at": "2025-11-08T15:30:22.520891Z"
      }
    },
    "task-1-3": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/study_workflow.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [
        "task-1-3-1",
        "task-1-3-2",
        "task-1-3-3"
      ],
      "dependencies": {
        "blocks": [
          "task-1-4"
        ],
        "blocked_by": [
          "task-1-1"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 3,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/study_workflow.py",
        "task_category": "implementation",
        "estimated_hours": 3,
        "description": "Implement StudyWorkflow class extending BaseWorkflow"
      }
    },
    "task-1-3-1": {
      "type": "subtask",
      "title": "Create StudyWorkflow class extending BaseWorkflow",
      "status": "completed",
      "parent": "task-1-3",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "details": "Implement workflow_type, execute() method, and basic workflow structure",
        "started_at": "2025-11-08T15:30:48.786352Z",
        "completed_at": "2025-11-08T15:31:58.734426Z",
        "needs_journaling": false,
        "actual_hours": 0.019,
        "journaled_at": "2025-11-08T15:31:58.745850Z"
      }
    },
    "task-1-3-2": {
      "type": "subtask",
      "title": "Add WorkflowRegistry decorator for plugin registration",
      "status": "completed",
      "parent": "task-1-3",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "details": "@WorkflowRegistry.register('study')",
        "started_at": "2025-11-08T15:32:29.841850Z",
        "completed_at": "2025-11-08T15:32:43.494005Z",
        "needs_journaling": false,
        "actual_hours": 0.004,
        "journaled_at": "2025-11-08T15:32:43.506543Z"
      }
    },
    "task-1-3-3": {
      "type": "subtask",
      "title": "Implement basic investigation flow skeleton",
      "status": "completed",
      "parent": "task-1-3",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "details": "Create workflow execution loop with persona invocation hooks",
        "started_at": "2025-11-08T15:33:07.285020Z",
        "completed_at": "2025-11-08T15:34:24.368822Z",
        "needs_journaling": false,
        "actual_hours": 0.021,
        "journaled_at": "2025-11-08T15:34:24.380078Z"
      }
    },
    "task-1-4": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/models.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [
        "task-1-4-1",
        "task-1-4-2",
        "task-1-4-3"
      ],
      "dependencies": {
        "blocks": [
          "task-1-5"
        ],
        "blocked_by": [
          "task-1-3"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 3,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/models.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "description": "Define data models for STUDY workflow"
      }
    },
    "task-1-4-1": {
      "type": "subtask",
      "title": "Create InvestigationPhase enum (DISCOVERY, VALIDATION, PLANNING, COMPLETE)",
      "status": "completed",
      "parent": "task-1-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "started_at": "2025-11-08T15:34:50.719707Z",
        "completed_at": "2025-11-08T15:35:29.575936Z",
        "needs_journaling": false,
        "actual_hours": 0.011,
        "journaled_at": "2025-11-08T15:35:29.583341Z"
      }
    },
    "task-1-4-2": {
      "type": "subtask",
      "title": "Create ConfidenceLevel enum (EXPLORING, LOW, MEDIUM, HIGH)",
      "status": "completed",
      "parent": "task-1-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "started_at": "2025-11-08T15:35:59.670254Z",
        "completed_at": "2025-11-08T15:36:15.913648Z",
        "needs_journaling": false,
        "actual_hours": 0.005,
        "journaled_at": "2025-11-08T15:36:15.930434Z"
      }
    },
    "task-1-4-3": {
      "type": "subtask",
      "title": "Create StudyState Pydantic model with phase, confidence, findings",
      "status": "completed",
      "parent": "task-1-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "details": "Include investigation_id, session_id, current_phase, confidence, iteration_count, findings[]",
        "started_at": "2025-11-08T15:36:41.450042Z",
        "completed_at": "2025-11-08T15:37:37.566206Z",
        "needs_journaling": false,
        "actual_hours": 0.016,
        "journaled_at": "2025-11-08T15:37:37.584528Z"
      }
    },
    "task-1-5": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/state_machine.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [
        "task-1-5-1",
        "task-1-5-2"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-1-4"
        ],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 2,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/state_machine.py",
        "task_category": "implementation",
        "estimated_hours": 3,
        "description": "Implement investigation phase state machine"
      }
    },
    "task-1-5-1": {
      "type": "subtask",
      "title": "Create InvestigationStateMachine class with phase transitions",
      "status": "completed",
      "parent": "task-1-5",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "details": "Implement can_transition(), transition(), get_next_phase() methods",
        "started_at": "2025-11-08T15:38:03.299298Z",
        "completed_at": "2025-11-08T15:39:02.569518Z",
        "needs_journaling": false,
        "actual_hours": 0.016,
        "journaled_at": "2025-11-08T15:39:02.578538Z"
      }
    },
    "task-1-5-2": {
      "type": "subtask",
      "title": "Add confidence level progression logic",
      "status": "completed",
      "parent": "task-1-5",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "details": "Methods: update_confidence(), should_escalate_phase()",
        "started_at": "2025-11-08T15:39:28.493652Z",
        "completed_at": "2025-11-08T15:40:26.032911Z",
        "needs_journaling": false,
        "actual_hours": 0.016,
        "journaled_at": "2025-11-08T15:40:26.041116Z"
      }
    },
    "task-1-6": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/config.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/config.py",
        "task_category": "implementation",
        "estimated_hours": 1,
        "description": "Create configuration dataclass for STUDY workflow defaults",
        "started_at": "2025-11-08T15:40:52.773781Z",
        "completed_at": "2025-11-08T15:41:55.900163Z",
        "needs_journaling": false,
        "actual_hours": 0.018,
        "journaled_at": "2025-11-08T15:41:55.913251Z"
      }
    },
    "phase-1-verify": {
      "type": "group",
      "title": "Verification",
      "status": "in_progress",
      "parent": "phase-1",
      "children": [
        "verify-1-1",
        "verify-1-2",
        "verify-1-3"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-1-files"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 1,
      "metadata": {}
    },
    "verify-1-1": {
      "type": "verify",
      "title": "Import validation - workflow and models load correctly",
      "status": "completed",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "verification_type": "auto",
        "command": "python -c 'from model_chorus.workflows.study import StudyWorkflow, StudyState'",
        "expected": "No import errors, all modules load successfully",
        "started_at": "2025-11-08T15:42:21.981992Z",
        "completed_at": "2025-11-08T15:43:29.451052Z",
        "needs_journaling": false,
        "actual_hours": 0.019,
        "journaled_at": "2025-11-08T15:43:29.463454Z"
      }
    },
    "verify-1-2": {
      "type": "verify",
      "title": "State machine transitions follow valid paths",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest model_chorus/tests/workflows/study/test_state_machine.py",
        "expected": "All state transition tests pass"
      }
    },
    "verify-1-3": {
      "type": "verify",
      "title": "Phase 1 implementation fidelity review",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "fidelity",
        "skill": "sdd-fidelity-review",
        "scope": "phase",
        "target": "phase-1",
        "on_failure": {
          "consult": true,
          "revert_status": "in_progress",
          "continue_on_failure": false
        },
        "command": "",
        "expected": ""
      }
    },
    "phase-2": {
      "type": "phase",
      "title": "Persona System Implementation",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-2-files",
        "phase-2-verify"
      ],
      "dependencies": {
        "blocks": [
          "phase-3"
        ],
        "blocked_by": [
          "phase-1"
        ],
        "depends": []
      },
      "total_tasks": 10,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement three core personas with distinct reasoning approaches",
        "risk_level": "medium",
        "estimated_hours": 10
      }
    },
    "phase-2-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-2",
      "children": [
        "task-2-1",
        "task-2-2",
        "task-2-3",
        "task-2-4",
        "task-2-5"
      ],
      "total_tasks": 7,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-2-verify"
        ]
      }
    },
    "task-2-1": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/persona.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [
        "task-2-1-1",
        "task-2-1-2",
        "task-2-1-3"
      ],
      "dependencies": {
        "blocks": [
          "task-2-2",
          "task-2-3",
          "task-2-4"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/persona.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "description": "Create base Persona class and configuration"
      }
    },
    "task-2-1-1": {
      "type": "subtask",
      "title": "Create Persona dataclass with name, prompt_template, temperature, max_tokens",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-2-1-2": {
      "type": "subtask",
      "title": "Create PersonaRegistry class for managing available personas",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Methods: register(), get(), list_all()"
      }
    },
    "task-2-1-3": {
      "type": "subtask",
      "title": "Add persona execution interface with invoke() method",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Takes context, returns PersonaResponse with findings and confidence update"
      }
    },
    "task-2-2": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/personas/researcher.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-2-5"
        ],
        "blocked_by": [
          "task-2-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/personas/researcher.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "description": "Implement Researcher persona with deep analysis focus"
      }
    },
    "task-2-3": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/personas/critic.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-2-5"
        ],
        "blocked_by": [
          "task-2-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/personas/critic.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "description": "Implement Critic persona with challenge and stress-test focus"
      }
    },
    "task-2-4": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/personas/planner.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-2-5"
        ],
        "blocked_by": [
          "task-2-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/personas/planner.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "description": "Implement Planner persona with actionable roadmap focus"
      }
    },
    "task-2-5": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/personas/__init__.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-2-2",
          "task-2-3",
          "task-2-4"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/personas/__init__.py",
        "task_category": "implementation",
        "estimated_hours": 0.5,
        "description": "Create personas package with exports and registry initialization"
      }
    },
    "phase-2-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-2",
      "children": [
        "verify-2-1",
        "verify-2-2",
        "verify-2-3"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-2-files"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-2-1": {
      "type": "verify",
      "title": "All three personas registered and accessible",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "python -c 'from model_chorus.workflows.study.personas import PersonaRegistry; assert len(PersonaRegistry.list_all()) == 3'",
        "expected": "Three personas: researcher, critic, planner"
      }
    },
    "verify-2-2": {
      "type": "verify",
      "title": "Persona prompts have distinct reasoning approaches",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "checklist": [
          "Researcher focuses on evidence gathering and pattern identification",
          "Critic challenges assumptions and identifies weaknesses",
          "Planner creates actionable implementation steps"
        ],
        "command": "",
        "expected": ""
      }
    },
    "verify-2-3": {
      "type": "verify",
      "title": "Phase 2 implementation fidelity review",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "fidelity",
        "skill": "sdd-fidelity-review",
        "scope": "phase",
        "target": "phase-2",
        "on_failure": {
          "consult": true,
          "revert_status": "in_progress",
          "continue_on_failure": false
        },
        "command": "",
        "expected": ""
      }
    },
    "phase-3": {
      "type": "phase",
      "title": "LLM-Based Routing System",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-3-files",
        "phase-3-verify"
      ],
      "dependencies": {
        "blocks": [
          "phase-4"
        ],
        "blocked_by": [
          "phase-2"
        ],
        "depends": []
      },
      "total_tasks": 10,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement intelligent persona routing using LLM-based skill analysis",
        "risk_level": "medium",
        "estimated_hours": 8
      }
    },
    "phase-3-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-3",
      "children": [
        "task-3-1",
        "task-3-2",
        "task-3-3"
      ],
      "total_tasks": 7,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-3-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-3-1": {
      "type": "task",
      "title": ".claude/skills/study-routing/SKILL.md",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [
        "task-3-1-1",
        "task-3-1-2",
        "task-3-1-3"
      ],
      "dependencies": {
        "blocks": [
          "task-3-2"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": ".claude/skills/study-routing/SKILL.md",
        "task_category": "implementation",
        "estimated_hours": 3,
        "description": "Create routing skill for persona selection analysis"
      }
    },
    "task-3-1-1": {
      "type": "subtask",
      "title": "Define skill frontmatter with context analysis parameters",
      "status": "pending",
      "parent": "task-3-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Input: current_phase, confidence, findings, unresolved_questions, prior_persona"
      }
    },
    "task-3-1-2": {
      "type": "subtask",
      "title": "Create routing decision prompt template",
      "status": "pending",
      "parent": "task-3-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Analyze investigation state and recommend next persona with reasoning"
      }
    },
    "task-3-1-3": {
      "type": "subtask",
      "title": "Define structured output format (JSON with persona, reasoning, confidence)",
      "status": "pending",
      "parent": "task-3-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-3-2": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/routing.py",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [
        "task-3-2-1",
        "task-3-2-2",
        "task-3-2-3"
      ],
      "dependencies": {
        "blocks": [
          "task-3-3"
        ],
        "blocked_by": [
          "task-3-1"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/routing.py",
        "task_category": "implementation",
        "estimated_hours": 3,
        "description": "Implement routing logic that invokes LLM-based skill"
      }
    },
    "task-3-2-1": {
      "type": "subtask",
      "title": "Create PersonaRouter class with skill invocation",
      "status": "pending",
      "parent": "task-3-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Invoke study-routing skill with investigation context"
      }
    },
    "task-3-2-2": {
      "type": "subtask",
      "title": "Add routing decision tracking and logging",
      "status": "pending",
      "parent": "task-3-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Store routing history: timestamp, context, decision, reasoning"
      }
    },
    "task-3-2-3": {
      "type": "subtask",
      "title": "Implement fallback routing logic if skill invocation fails",
      "status": "pending",
      "parent": "task-3-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Simple rule-based fallback: DISCOVERY->researcher, VALIDATION->critic, PLANNING->planner"
      }
    },
    "task-3-3": {
      "type": "task",
      "title": "Integrate routing into StudyWorkflow",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-3-2"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/study_workflow.py",
        "task_category": "refactoring",
        "estimated_hours": 1,
        "description": "Update StudyWorkflow to use PersonaRouter for persona selection"
      }
    },
    "phase-3-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-3",
      "children": [
        "verify-3-1",
        "verify-3-2",
        "verify-3-3"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-3-files"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-3-1": {
      "type": "verify",
      "title": "Routing skill invokes successfully and returns valid JSON",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest model_chorus/tests/workflows/study/test_routing.py::test_routing_skill_invocation",
        "expected": "Skill returns persona recommendation with reasoning"
      }
    },
    "verify-3-2": {
      "type": "verify",
      "title": "Fallback routing works when skill unavailable",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest model_chorus/tests/workflows/study/test_routing.py::test_fallback_routing",
        "expected": "Fallback rules provide valid persona selection"
      }
    },
    "verify-3-3": {
      "type": "verify",
      "title": "Phase 3 implementation fidelity review",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "fidelity",
        "skill": "sdd-fidelity-review",
        "scope": "phase",
        "target": "phase-3",
        "on_failure": {
          "consult": true,
          "revert_status": "in_progress",
          "continue_on_failure": false
        },
        "command": "",
        "expected": ""
      }
    },
    "phase-4": {
      "type": "phase",
      "title": "Memory System Implementation",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-4-files",
        "phase-4-verify"
      ],
      "dependencies": {
        "blocks": [
          "phase-5"
        ],
        "blocked_by": [
          "phase-3"
        ],
        "depends": []
      },
      "total_tasks": 15,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement dual-layer memory system with caching and persistence",
        "risk_level": "high",
        "estimated_hours": 16
      }
    },
    "phase-4-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-4",
      "children": [
        "task-4-1",
        "task-4-2",
        "task-4-3",
        "task-4-4",
        "task-4-5"
      ],
      "total_tasks": 12,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-4-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-4-1": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/memory/__init__.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/memory/__init__.py",
        "task_category": "implementation",
        "estimated_hours": 0.5,
        "description": "Create memory package structure"
      }
    },
    "task-4-2": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/memory/models.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [
        "task-4-2-1",
        "task-4-2-2"
      ],
      "dependencies": {
        "blocks": [
          "task-4-3",
          "task-4-4"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/memory/models.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "description": "Define memory entry data models"
      }
    },
    "task-4-2-1": {
      "type": "subtask",
      "title": "Create MemoryEntry Pydantic model",
      "status": "pending",
      "parent": "task-4-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Fields: investigation_id, session_id, timestamp, persona, findings, evidence, confidence_before, confidence_after, memory_references"
      }
    },
    "task-4-2-2": {
      "type": "subtask",
      "title": "Create MemoryQuery model for search operations",
      "status": "pending",
      "parent": "task-4-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Support filtering by: investigation_id, persona, confidence_level, time_range"
      }
    },
    "task-4-3": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/memory/cache.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [
        "task-4-3-1",
        "task-4-3-2",
        "task-4-3-3"
      ],
      "dependencies": {
        "blocks": [
          "task-4-5"
        ],
        "blocked_by": [
          "task-4-2"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/memory/cache.py",
        "task_category": "implementation",
        "estimated_hours": 3,
        "description": "Implement in-memory short-term cache"
      }
    },
    "task-4-3-1": {
      "type": "subtask",
      "title": "Create ShortTermCache class with LRU eviction",
      "status": "pending",
      "parent": "task-4-3",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Use OrderedDict for LRU, configurable max size (default 100 entries)"
      }
    },
    "task-4-3-2": {
      "type": "subtask",
      "title": "Implement cache operations: get, put, invalidate",
      "status": "pending",
      "parent": "task-4-3",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-4-3-3": {
      "type": "subtask",
      "title": "Add cache metrics tracking (hits, misses, evictions)",
      "status": "pending",
      "parent": "task-4-3",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-4-4": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/memory/persistence.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [
        "task-4-4-1",
        "task-4-4-2",
        "task-4-4-3"
      ],
      "dependencies": {
        "blocks": [
          "task-4-5"
        ],
        "blocked_by": [
          "task-4-2"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/memory/persistence.py",
        "task_category": "implementation",
        "estimated_hours": 4,
        "description": "Implement SQLite-based long-term persistence"
      }
    },
    "task-4-4-1": {
      "type": "subtask",
      "title": "Create LongTermStorage class with SQLite backend",
      "status": "pending",
      "parent": "task-4-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Database schema: investigations, memory_entries, memory_references tables"
      }
    },
    "task-4-4-2": {
      "type": "subtask",
      "title": "Implement storage operations: save, query, get_by_investigation",
      "status": "pending",
      "parent": "task-4-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-4-4-3": {
      "type": "subtask",
      "title": "Add indexing for efficient queries (investigation_id, timestamp, persona)",
      "status": "pending",
      "parent": "task-4-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-4-5": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/workflows/study/memory/controller.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [
        "task-4-5-1",
        "task-4-5-2",
        "task-4-5-3"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-4-3",
          "task-4-4"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/workflows/study/memory/controller.py",
        "task_category": "implementation",
        "estimated_hours": 4,
        "description": "Create memory controller coordinating cache and persistence"
      }
    },
    "task-4-5-1": {
      "type": "subtask",
      "title": "Create MemoryController class coordinating short-term and long-term",
      "status": "pending",
      "parent": "task-4-5",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Automatic write-through from cache to persistence"
      }
    },
    "task-4-5-2": {
      "type": "subtask",
      "title": "Implement unified query interface with cache-first lookup",
      "status": "pending",
      "parent": "task-4-5",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Check cache first, fallback to persistence, promote to cache on hit"
      }
    },
    "task-4-5-3": {
      "type": "subtask",
      "title": "Add memory lifecycle: store, retrieve, context_window_management",
      "status": "pending",
      "parent": "task-4-5",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Context window management: retrieve most relevant memories, hierarchical compression"
      }
    },
    "phase-4-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-4",
      "children": [
        "verify-4-1",
        "verify-4-2",
        "verify-4-3"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-4-files"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-4-1": {
      "type": "verify",
      "title": "Memory persistence and retrieval works correctly",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest model_chorus/tests/workflows/study/memory/test_persistence.py",
        "expected": "All memory CRUD operations succeed, data persists across sessions"
      }
    },
    "verify-4-2": {
      "type": "verify",
      "title": "Cache eviction and promotion working as expected",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest model_chorus/tests/workflows/study/memory/test_cache.py",
        "expected": "LRU eviction triggers correctly, cache metrics accurate"
      }
    },
    "verify-4-3": {
      "type": "verify",
      "title": "Phase 4 implementation fidelity review",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "fidelity",
        "skill": "sdd-fidelity-review",
        "scope": "phase",
        "target": "phase-4",
        "on_failure": {
          "consult": true,
          "revert_status": "in_progress",
          "continue_on_failure": false
        },
        "command": "",
        "expected": ""
      }
    },
    "phase-5": {
      "type": "phase",
      "title": "CLI Integration",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-5-files",
        "phase-5-verify"
      ],
      "dependencies": {
        "blocks": [
          "phase-6"
        ],
        "blocked_by": [
          "phase-4"
        ],
        "depends": []
      },
      "total_tasks": 10,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Integrate STUDY workflow into ModelChorus CLI",
        "risk_level": "low",
        "estimated_hours": 8
      }
    },
    "phase-5-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-5",
      "children": [
        "task-5-1",
        "task-5-2",
        "task-5-3",
        "task-5-4"
      ],
      "total_tasks": 7,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-5-verify"
        ]
      }
    },
    "task-5-1": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/cli/study_commands.py",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [
        "task-5-1-1",
        "task-5-1-2",
        "task-5-1-3"
      ],
      "dependencies": {
        "blocks": [
          "task-5-2",
          "task-5-4"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/cli/study_commands.py",
        "task_category": "implementation",
        "estimated_hours": 4,
        "description": "Create CLI commands for STUDY workflow"
      }
    },
    "task-5-1-1": {
      "type": "subtask",
      "title": "Implement `study` command for new investigations",
      "status": "pending",
      "parent": "task-5-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Usage: model-chorus study --scenario 'investigation description' [--provider claude]"
      }
    },
    "task-5-1-2": {
      "type": "subtask",
      "title": "Implement `study-next` command for continuing investigations",
      "status": "pending",
      "parent": "task-5-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Usage: model-chorus study-next --investigation <uuid>"
      }
    },
    "task-5-1-3": {
      "type": "subtask",
      "title": "Implement `study-view` command for memory inspection",
      "status": "pending",
      "parent": "task-5-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Usage: model-chorus study-view --investigation <uuid> [--persona researcher]"
      }
    },
    "task-5-2": {
      "type": "task",
      "title": "model_chorus/src/model_chorus/cli/main.py",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [
        "task-5-2-1",
        "task-5-2-2"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-5-1"
        ],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/src/model_chorus/cli/main.py",
        "task_category": "refactoring",
        "estimated_hours": 1,
        "description": "Register STUDY commands in main CLI"
      }
    },
    "task-5-2-1": {
      "type": "subtask",
      "title": "Import and register study command group",
      "status": "pending",
      "parent": "task-5-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "app.add_typer(study_app, name='study')"
      }
    },
    "task-5-2-2": {
      "type": "subtask",
      "title": "Add study command to help text and documentation",
      "status": "pending",
      "parent": "task-5-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-5-3": {
      "type": "task",
      "title": ".model-chorusrc",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": ".model-chorusrc",
        "task_category": "implementation",
        "estimated_hours": 0.5,
        "description": "Add STUDY workflow configuration defaults"
      }
    },
    "task-5-4": {
      "type": "task",
      "title": "README.md",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-5-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "README.md",
        "task_category": "implementation",
        "estimated_hours": 1,
        "description": "Add STUDY workflow documentation to README"
      }
    },
    "phase-5-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-5",
      "children": [
        "verify-5-1",
        "verify-5-2",
        "verify-5-3"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-5-files"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-5-1": {
      "type": "verify",
      "title": "All CLI commands available and show help text",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "model-chorus study --help && model-chorus study-next --help && model-chorus study-view --help",
        "expected": "All commands display help text without errors"
      }
    },
    "verify-5-2": {
      "type": "verify",
      "title": "Basic investigation flow works end-to-end",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "checklist": [
          "Start investigation: model-chorus study --scenario 'test investigation'",
          "Continue investigation: model-chorus study-next --investigation <uuid>",
          "View memory: model-chorus study-view --investigation <uuid>",
          "Verify memory persists across commands"
        ],
        "command": "",
        "expected": ""
      }
    },
    "verify-5-3": {
      "type": "verify",
      "title": "Phase 5 implementation fidelity review",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "fidelity",
        "skill": "sdd-fidelity-review",
        "scope": "phase",
        "target": "phase-5",
        "on_failure": {
          "consult": true,
          "revert_status": "in_progress",
          "continue_on_failure": false
        },
        "command": "",
        "expected": ""
      }
    },
    "phase-6": {
      "type": "phase",
      "title": "Testing & Documentation",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-6-files",
        "phase-6-verify"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-5"
        ],
        "depends": []
      },
      "total_tasks": 9,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Comprehensive testing and documentation for production readiness",
        "risk_level": "low",
        "estimated_hours": 10
      }
    },
    "phase-6-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-6",
      "children": [
        "task-6-1",
        "task-6-2",
        "task-6-3",
        "task-6-4"
      ],
      "total_tasks": 6,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-6-verify"
        ]
      }
    },
    "task-6-1": {
      "type": "task",
      "title": "model_chorus/tests/workflows/study/test_study_workflow.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/tests/workflows/study/test_study_workflow.py",
        "task_category": "implementation",
        "estimated_hours": 3,
        "description": "Create integration tests for complete workflow"
      }
    },
    "task-6-2": {
      "type": "task",
      "title": "model_chorus/tests/workflows/study/test_personas.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/tests/workflows/study/test_personas.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "description": "Create unit tests for persona system"
      }
    },
    "task-6-3": {
      "type": "task",
      "title": "model_chorus/tests/workflows/study/test_routing.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "model_chorus/tests/workflows/study/test_routing.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "description": "Create tests for routing logic and skill invocation"
      }
    },
    "task-6-4": {
      "type": "task",
      "title": "docs/workflows/STUDY.md",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [
        "task-6-4-1",
        "task-6-4-2",
        "task-6-4-3"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "docs/workflows/STUDY.md",
        "task_category": "implementation",
        "estimated_hours": 3,
        "description": "Create comprehensive STUDY workflow documentation"
      }
    },
    "task-6-4-1": {
      "type": "subtask",
      "title": "Document workflow overview and use cases",
      "status": "pending",
      "parent": "task-6-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-6-4-2": {
      "type": "subtask",
      "title": "Document CLI commands with examples",
      "status": "pending",
      "parent": "task-6-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-6-4-3": {
      "type": "subtask",
      "title": "Document memory system and investigation lifecycle",
      "status": "pending",
      "parent": "task-6-4",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "phase-6-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-6",
      "children": [
        "verify-6-1",
        "verify-6-2",
        "verify-6-3"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-6-files"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-6-1": {
      "type": "verify",
      "title": "All tests pass with adequate coverage",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest model_chorus/tests/workflows/study/ --cov=model_chorus.workflows.study --cov-report=term",
        "expected": "All tests pass, coverage > 80%"
      }
    },
    "verify-6-2": {
      "type": "verify",
      "title": "Documentation is complete and accurate",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "checklist": [
          "All CLI commands documented with examples",
          "Workflow overview clear and comprehensive",
          "Use cases demonstrate value proposition",
          "Memory system explained with diagrams",
          "Troubleshooting section included"
        ],
        "command": "",
        "expected": ""
      }
    },
    "verify-6-3": {
      "type": "verify",
      "title": "Phase 6 implementation fidelity review",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "fidelity",
        "skill": "sdd-fidelity-review",
        "scope": "phase",
        "target": "phase-6",
        "on_failure": {
          "consult": true,
          "revert_status": "in_progress",
          "continue_on_failure": false
        },
        "command": "",
        "expected": ""
      }
    }
  },
  "journal": [
    {
      "timestamp": "2025-11-08T15:00:13.440412Z",
      "entry_type": "status_change",
      "title": "Task Completed: Review BaseWorkflow interface and inheritance pattern",
      "author": "claude-code",
      "content": "Successfully reviewed BaseWorkflow interface and inheritance patterns. Key findings:\n\n1. BaseWorkflow provides solid abstract foundation with run() method, provider fallback utilities, conversation support, and structured WorkflowResult format\n2. Identified architectural drift: ConsensusWorkflow does NOT inherit from BaseWorkflow (uses execute() instead of run(), custom ConsensusResult type)\n3. Documented clear inheritance pattern for StudyWorkflow: should inherit from BaseWorkflow, use WorkflowStep.metadata for persona-specific data, leverage _execute_with_fallback() for resilience\n4. Identified 4 architectural gaps: progress events, multi-round pattern, provider strategy guidance, synthesis sophistication\n5. Created comprehensive findings document with recommendations for STUDY implementation\n\nAll research objectives met. Ready to proceed with task-1-1-2 (Study Consensus workflow patterns).",
      "metadata": {},
      "task_id": "task-1-1-1"
    },
    {
      "timestamp": "2025-11-08T15:09:56.209620Z",
      "entry_type": "status_change",
      "title": "Task Completed: Study RoleOrchestrator for persona implementation pattern",
      "author": "claude-code",
      "content": "Successfully analyzed RoleOrchestrator infrastructure for persona implementation. Key findings:\n\n1. ModelRole provides excellent persona definition with role, model, stance, prompts, temperature, and extensible metadata field - perfect for STUDY personas with expertise/focus/hypothesis tracking\n2. RoleOrchestrator supports SEQUENTIAL (turn-taking) and PARALLEL (concurrent) execution patterns with critical context parameter enabling multi-round dialogue\n3. Four synthesis strategies analyzed: NONE, CONCATENATE (display), STRUCTURED (tracking), AI_SYNTHESIZE (hypothesis refinement) - AI_SYNTHESIZE ideal for STUDY's hypothesis evolution\n4. Recommended composition pattern: StudyWorkflow inherits BaseWorkflow, composes RoleOrchestrator internally for multi-round logic\n5. Identified gaps: multi-round loop (STUDY responsibility), hypothesis tracking (metadata + STRUCTURED), dynamic pattern switching for hybrid mode\n\nCreated comprehensive findings document with implementation guidance. Ready to proceed with task-1-1-3 (Study Zen MCP STUDY reference).",
      "metadata": {},
      "task_id": "task-1-1-2"
    },
    {
      "timestamp": "2025-11-08T15:21:15.182696Z",
      "entry_type": "status_change",
      "title": "Task Completed: Examine ConversationMemory for state persistence approach",
      "author": "claude-code",
      "content": "Successfully analyzed ConversationMemory infrastructure for state persistence. Key findings:\n\n1. File-based persistence with UUID threads, file locking, TTL-based cleanup survives process restarts - perfect for multi-session research\n2. Thread lifecycle management with active/completed/archived states and automatic expiration (default 3 hours, recommend 24 for STUDY)\n3. thread.state dict is primary state persistence mechanism - recommend Pydantic models (StudyState, RoundState, PersonaPosition) following ThinkDeepState pattern\n4. build_conversation_history() provides rich context with file tracking and message truncation - recommend hybrid strategy (conversation memory + round synthesis)\n5. Complete integration pattern documented: StudyWorkflow(BaseWorkflow) + RoleOrchestrator + ConversationMemory\n\nCreated comprehensive findings document with state management patterns, context strategies, and complete integration example. Ready for task-1-2 (Design StudyWorkflow skeleton).",
      "metadata": {},
      "task_id": "task-1-1-3"
    },
    {
      "timestamp": "2025-11-08T15:30:22.520865Z",
      "entry_type": "status_change",
      "title": "Task Completed: model_chorus/src/model_chorus/workflows/study/__init__.py",
      "author": "claude-code",
      "content": "Successfully created STUDY workflow package directory structure with __init__.py file. The package follows established patterns from other workflows (ideate, argument) with proper docstring and exports. Directory created at model_chorus/src/model_chorus/workflows/study/ with __init__.py exporting StudyWorkflow (to be implemented in next task). Package structure verified and matches existing workflow conventions.",
      "metadata": {},
      "task_id": "task-1-2"
    },
    {
      "timestamp": "2025-11-08T15:31:58.745836Z",
      "entry_type": "status_change",
      "title": "Task Completed: Create StudyWorkflow class extending BaseWorkflow",
      "author": "claude-code",
      "content": "Successfully created StudyWorkflow class extending BaseWorkflow in study_workflow.py. Implementation includes: (1) Proper class inheritance from BaseWorkflow, (2) @WorkflowRegistry.register(\"study\") decorator for workflow registration, (3) __init__ method matching pattern from IdeateWorkflow with provider, fallback_providers, config, and conversation_memory parameters, (4) async run() method with proper signature including prompt, continuation_id, files, and skip_provider_check parameters, (5) Comprehensive docstrings explaining persona-based research workflow, (6) Placeholder implementation with proper event emission (emit_workflow_start/complete), (7) Import verification successful - module can be imported and class is properly registered. File created at model_chorus/src/model_chorus/workflows/study/study_workflow.py (222 lines).",
      "metadata": {},
      "task_id": "task-1-3-1"
    },
    {
      "timestamp": "2025-11-08T15:32:43.506531Z",
      "entry_type": "status_change",
      "title": "Task Completed: Add WorkflowRegistry decorator for plugin registration",
      "author": "claude-code",
      "content": "WorkflowRegistry decorator already added to StudyWorkflow class during task-1-3-1 implementation. Verified decorator exists at line 29 of study_workflow.py with correct registration key \"study\". The @WorkflowRegistry.register(\"study\") decorator properly registers the workflow in the plugin system, allowing it to be discovered and instantiated by the workflow factory. Registration confirmed via import test in previous task.",
      "metadata": {},
      "task_id": "task-1-3-2"
    },
    {
      "timestamp": "2025-11-08T15:34:24.380062Z",
      "entry_type": "status_change",
      "title": "Task Completed: Implement basic investigation flow skeleton",
      "author": "claude-code",
      "content": "Successfully implemented investigation flow skeleton in StudyWorkflow run() method. Implementation includes: (1) Provider availability checking with proper error handling, (2) Thread ID management and conversation history retrieval, (3) Three-phase investigation flow structure (Setup Personas, Investigation Loop, Synthesis), (4) Helper methods created: _setup_personas() with default persona configurations (Researcher and Critic), _conduct_investigation() for main investigation loop with persona invocation hooks, _synthesize_findings() for result synthesis, (5) Proper workflow event emission (emit_workflow_start/complete), (6) Comprehensive error handling and logging, (7) Result metadata tracking including thread_id, personas_used, investigation_rounds. Flow skeleton ready for actual persona invocation implementation in subsequent tasks. Verified all methods available via import inspection.",
      "metadata": {},
      "task_id": "task-1-3-3"
    },
    {
      "timestamp": "2025-11-08T15:35:29.583329Z",
      "entry_type": "status_change",
      "title": "Task Completed: Create InvestigationPhase enum (DISCOVERY, VALIDATION, PLANNING, COMPLETE)",
      "author": "claude-code",
      "content": "Successfully created InvestigationPhase enum in model_chorus/src/model_chorus/core/models.py. Implementation includes: (1) Enum defined as string enum following the same pattern as ConfidenceLevel, (2) Four phases defined: DISCOVERY (initial exploration), VALIDATION (critical examination), PLANNING (synthesis and organization), COMPLETE (investigation concluded), (3) Comprehensive docstring explaining purpose and phase progression for persona-based research workflows, (4) Import verification successful - enum can be imported and all phase values accessible. Enum added at line 43 of models.py, immediately after ConfidenceLevel enum.",
      "metadata": {},
      "task_id": "task-1-4-1"
    },
    {
      "timestamp": "2025-11-08T15:36:15.930402Z",
      "entry_type": "status_change",
      "title": "Task Completed: Create ConfidenceLevel enum (EXPLORING, LOW, MEDIUM, HIGH)",
      "author": "claude-code",
      "content": "ConfidenceLevel enum already exists in model_chorus/src/model_chorus/core/models.py at lines 16-40. The enum was created previously for the Thinkdeep workflow. It includes all required levels: EXPLORING, LOW, MEDIUM, HIGH, plus additional levels VERY_HIGH, ALMOST_CERTAIN, and CERTAIN for more granular confidence tracking. The enum follows the string enum pattern and has comprehensive documentation. Import verification successful - enum is accessible and all 7 confidence levels are available. This enum can be reused for Study workflow's confidence tracking needs.",
      "metadata": {},
      "task_id": "task-1-4-2"
    },
    {
      "timestamp": "2025-11-08T15:37:37.584500Z",
      "entry_type": "status_change",
      "title": "Task Completed: Create StudyState Pydantic model with phase, confidence, findings",
      "author": "claude-code",
      "content": "Successfully created StudyState Pydantic model in model_chorus/src/model_chorus/core/models.py at line 784. Implementation includes: (1) All required fields: investigation_id (str, required), session_id (str, required), current_phase (str with default 'discovery'), confidence (str with default 'exploring'), iteration_count (int with default 0), findings (List[Dict] with default empty list), (2) Additional tracking fields: personas_active (List[str] for active personas) and relevant_files (List[str] for examined files), (3) Comprehensive docstring explaining purpose for multi-persona investigations, (4) Example configuration in model_config showing realistic investigation scenario with Researcher and Critic personas, (5) Proper Pydantic Field definitions with descriptions for all attributes, (6) Import and instantiation verification successful - model can be created with defaults and all fields accessible. Model follows the same pattern as ThinkDeepState for consistency.",
      "metadata": {},
      "task_id": "task-1-4-3"
    },
    {
      "timestamp": "2025-11-08T15:39:02.578520Z",
      "entry_type": "status_change",
      "title": "Task Completed: Create InvestigationStateMachine class with phase transitions",
      "author": "claude-code",
      "content": "Successfully created InvestigationStateMachine class in model_chorus/src/model_chorus/workflows/study/state_machine.py. Implementation includes: (1) Phase transition logic with valid transition mapping (DISCOVERY\u2192VALIDATION, VALIDATION\u2192PLANNING or DISCOVERY, PLANNING\u2192COMPLETE or DISCOVERY, COMPLETE is terminal), (2) Required methods implemented: can_transition() validates if target phase is reachable, transition() executes phase change with validation and logging, get_next_phase() returns primary next phase in progression, (3) Additional helper methods: get_valid_transitions() lists all valid transitions, is_terminal() checks for COMPLETE state, advance_to_next() convenience method for forward progression, reset_to_discovery() allows returning to discovery from validation/planning phases, (4) Comprehensive error handling with descriptive ValueError messages for invalid transitions, (5) Logging integration for transition tracking, (6) Test verification successful - state machine correctly validates transitions, prevents invalid transitions, and maintains state consistency. Class integrates with StudyState model and InvestigationPhase enum.",
      "metadata": {},
      "task_id": "task-1-5-1"
    },
    {
      "timestamp": "2025-11-08T15:40:26.041100Z",
      "entry_type": "status_change",
      "title": "Task Completed: Add confidence level progression logic",
      "author": "claude-code",
      "content": "Successfully added confidence level progression logic to InvestigationStateMachine class. Implementation includes: (1) update_confidence() method that updates StudyState confidence with logging of old\u2192new transition, (2) should_escalate_phase() method that determines if current confidence meets threshold for phase escalation using phase-specific thresholds (DISCOVERY requires MEDIUM+, VALIDATION/PLANNING require HIGH+), (3) get_confidence_threshold() helper method to query required confidence for any phase, (4) Confidence ordering system for numeric comparison (EXPLORING=0 through CERTAIN=6), (5) Comprehensive logging for confidence updates and escalation decisions, (6) Test verification successful - confidence updates tracked correctly, escalation logic validates thresholds properly, and threshold queries return correct values. Methods integrate seamlessly with existing state machine phase transition logic.",
      "metadata": {},
      "task_id": "task-1-5-2"
    },
    {
      "timestamp": "2025-11-08T15:41:55.913229Z",
      "entry_type": "status_change",
      "title": "Task Completed: model_chorus/src/model_chorus/workflows/study/config.py",
      "author": "claude-code",
      "content": "Successfully created config.py with comprehensive configuration dataclasses for STUDY workflow. Implementation includes: (1) PersonaConfig dataclass for individual persona configuration with name, expertise, role, optional system_prompt, temperature override, and metadata fields, (2) StudyConfig dataclass for workflow-level configuration with default personas (Researcher at temp 0.7, Critic at temp 0.6), max_iterations (5), min_confidence_for_completion (high), enable_cross_persona_dialogue (True), temperature (0.7), max_tokens (4096), enable_file_analysis (True), collaboration_rounds (2), and metadata, (3) InvestigationResult dataclass for capturing investigation outcomes with investigation_id, final_phase, final_confidence, iteration_count, persona_findings dict, synthesis, relevant_files, and metadata, (4) All dataclasses use proper field defaults and factory functions for mutable types, (5) Comprehensive docstrings for each dataclass and field, (6) Test verification successful - all dataclasses can be instantiated with defaults and custom values. File created at model_chorus/src/model_chorus/workflows/study/config.py.",
      "metadata": {},
      "task_id": "task-1-6"
    },
    {
      "timestamp": "2025-11-08T15:41:55.924866Z",
      "entry_type": "status_change",
      "title": "Group Completed: File Modifications",
      "author": "claude-code",
      "content": "All child tasks in group phase-1-files have been completed.",
      "metadata": {},
      "task_id": "phase-1-files"
    },
    {
      "timestamp": "2025-11-08T15:43:29.463437Z",
      "entry_type": "status_change",
      "title": "Task Completed: Import validation - workflow and models load correctly",
      "author": "claude-code",
      "content": "Import validation successful. All modules load correctly without errors. Verified imports: (1) StudyWorkflow from model_chorus.workflows.study package, (2) StudyState from model_chorus.core.models, (3) InvestigationPhase from model_chorus.core.models. Updated workflows/__init__.py to export StudyWorkflow, StudyState, and InvestigationPhase in __all__ list. Test command executed successfully with proper sys.path configuration. All Phase 1 components are properly integrated and importable.",
      "metadata": {},
      "task_id": "verify-1-1"
    }
  ]
}